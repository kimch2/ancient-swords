--接受任务操作
function npcAct1()
    if(Hero:ActFun(1080,"daymask == 40",38) == true)then		--判断掩码
            Hero:ActFun(127,"任务已经完成过了，放弃任务也算做过了",0)				--显示系统文字
    else
	    if(Hero:ActFun(1080,"task has 0",38) == true)then				--判断任务链
            if(Hero:ActFun(1080,"step == 1",38) == true)then		--判断任务步骤
                     if(Hero:ActFun(1080,"task state 0",38) == true)then				  --判断任务状态

                          Hero:ActFun(1080,"task accept 1",38)                             --设置任务状态为1
                          Hero:ActFun(757,"",506004)

                    else
                          Hero:ActFun(127,"已经接受了任务",0)				--显示系统文字
                    end
             else
                 Hero:ActFun(127,"已经完成了任务",0)  	 	 --显示系统文字
             end
	   else
	       if(Hero:ActFun(508,"47 2",0) == true)then                               --判断背包是否有2个格子
               Hero:ActFun(1080,"task new 1",38)
               Hero:ActFun(1080,"task accept 1",38)				--设置任务状态为1
			   Hero:ActFun(127,"道具交给你了，展现师徒的默契吧",0)
               Hero:ActFun(757,"",506004)                                --给玩家自己名字的传功宝珠
			   --Hero:ActFun(1080,"daymask += 40",38)
			   local lev =  Hero:GetLev()

			   local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78","1015 117 98","1015 48 127","1015 134 78","1016 49 55","1016 137 75","1016 51 107","1017 82 83","1017 30 86","1017 66 38","1018 90 22","1018 72 79","1018 70 56","1019 43 137","1019 113 79","1019 16 75"}

                     if( lev >= 35 and  lev < 40)then  					 --35级以上师傅的任务
                               local x = math.random(3)
                               Hero:ActFun(764,y[x],506003)                            --给玩家带有随机坐标和自己名字的周天罗盘
                      elseif(lev >= 40 and  lev < 45)then             --40级以上师傅的任务
                               local x = math.random(6)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 45 and  lev < 50)then             --45级以上师傅的任务
                               local x = math.random(9)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 50 and  lev < 55)then             --50级以上师傅的任务
                               local x = math.random(12)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 55 and  lev < 60)then             --55级以上师傅的任务
                               local x = math.random(15)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 60 and  lev < 65)then             --60级以上师傅的任务
                               local x = math.random(18)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 65 and  lev < 70)then             --65级以上师傅的任务
                               local x = math.random(21)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 70 and  lev < 75)then             --70级以上师傅的任务
                               local x = math.random(24)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 75 and  lev < 80)then             --75级以上师傅的任务
                               local x = math.random(27)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 80 and  lev < 85)then             --80级以上师傅的任务
                               local x = math.random(30)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 85 and  lev < 90)then             --85级以上师傅的任务
                               local x = math.random(33)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 90 and  lev < 95)then             --90级以上师傅的任务
                               local x = math.random(36)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 95 and  lev < 100)then             --95级以上师傅的任务
                               local x = math.random(39)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78","1015 117 98","1015 48 127","1015 134 78"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 100 and  lev < 105)then             --100级以上师傅的任务
                               local x = math.random(42)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78","1015 117 98","1015 48 127","1015 134 78","1016 49 55","1016 137 75","1016 51 107"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 105 and  lev < 110)then             --105级以上师傅的任务
                               local x = math.random(45)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78","1015 117 98","1015 48 127","1015 134 78","1016 49 55","1016 137 75","1016 51 107","1017 82 83","1017 30 86","1017 66 38"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 110 and  lev < 115)then             --110级以上师傅的任务
                               local x = math.random(48)
                               --local y = {"1002 70 142","1002 83 75","1002 114 49","1003 45 109","1003 45 87","1003 143 68","1004 122 93","1004 36 114","1004 30 78","1005 139 87","1005 55 66","1005 104 23","1007 58 61","1007 85 141","1007 95 125","1008 67 153","1008 26 95","1008 77 42","1009 32 72","1009 85 83","1009 39 112","1010 108 31","1010 140 62","1010 74 136","1011 56 126","1011 27 107","1011 123 46","1012 94 30","1012 113 130","1012 88 85","1013 104 80","1013 28 90","1013 61 121","1014 57 121","1014 63 139","1014 72 78","1015 117 98","1015 48 127","1015 134 78","1016 49 55","1016 137 75","1016 51 107","1017 82 83","1017 30 86","1017 66 38","1018 90 22","1018 72 79","1018 70 56"}
                               Hero:ActFun(764,y[x],506003)
                      elseif(lev >= 115 )then             --115级以上师傅的任务
                               local x = math.random(51)
                               Hero:ActFun(764,y[x],506003)
					  end




			else
					Hero:ActFun(127,"背包已满，请先清理背包",0)
			end

        end
	end
end

--完成任务操作
function npcAct2()
  --if(Hero:ActFun(1080,"daymask == 40",38) == true)then				--判断掩码
  --else
    if(Hero:ActFun(1080,"task has 0",38) == true)then				--判断任务链
          if(Hero:ActFun(1080,"step == 1",38) == true)then				--判断任务步骤
                 if(Hero:ActFun(1080,"task state 0",38)== true)then				--判断任务状态
                        Hero:ActFun(127,"任务未接受",0)				--显示系统文字
    --判断任务是否已完成，已完成则进入下一步
				elseif(Hero:ActFun(1080,"task state 2",38) == true)then				--判断任务状态
                        Hero:ActFun(127,"任务已经完成了",0)				--显示系统文字
                elseif(Hero:ActFun(1080,"task state 3",38) == true)then				--判断任务状态
                        --if(Hero:ActFun(508,"47 1",0) == true)then                              --判断背包是否已满
                               Hero:ActFun(1080,"task end 1",38)				--设置第一步状态为完成
	                           Hero:ActFun(1080,"task delete 1",38)				--设置第一步状态为完成
                               --Hero:ActFun(1080,"step += 1",38)				--设置任务步骤数加1
					           Hero:AddMorAlity(200)                         --增加师德
							   Hero:ActFun(127,"你获得200点师德",0)
							   Hero:AddImpart(300)                           --增加传授度
                               Hero:ActFun(127,"你获得300点传授度",0)
								local exp = Hero:GetLev() * Hero:GetLev() * 50;
								Hero:ActFun(1001,string.format("exp += %d", exp),0)
                               Hero:ActFun(1080,"daymask += 40",38)
			                   --Hero:ActFun(498,"0",620089)

	                    --else
  	                        --Hero:ActFun(127,"背包已满，请先清理背包",0)
						--end

                elseif(Hero:ActFun(1080,"task state 1",38) == true)then					    --判断任务是否满足完成条件，不满足则进入下一步
                         Hero:ActFun(127,"任务条件不足",0)					   	--显示系统文字
			    else
                         Hero:ActFun(127,"任务已经完成过了",0)					   	 --显示系统文字
                end
         else
			  Hero:ActFun(127,"未接受任务",0)						 --显示系统文字
         end
    else
         Hero:ActFun(127,"未接受任务",0)					 --显示系统文字
    end
end

--取消任务操作
function npcAct3()
  --if(Hero:ActFun(1080,"daymask == 40",38) == true)then
    --Hero:ActFun(127,"任务已经完成过了",0)
  --else
  if(Hero:ActFun(1080,"task has 0",38) == true)then
    --Hero:ActFun(1080,"step = 1",38)
	  Hero:ActFun(498,"0",506003)
	  Hero:ActFun(498,"0",506004)
	  Hero:ActFun(1080,"daymask += 40",38)
	  Hero:ActFun(1080,"task end 1",38)				--设置第一步状态为完成
	  Hero:ActFun(1080,"task delete 1",38)				--设置第一步状态为完成
  else
    Hero:ActFun(127,"未接受任务",0)
  end
end

if(gContext==3100101)then
  npcAct1()
elseif(gContext==3100102)then
  npcAct2()
elseif(gContext==3100103)then
  npcAct3()
end

